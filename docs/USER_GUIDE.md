# Interactive Forest 使用指南 🎮

## 🚀 快速启动

### 1. 启动后端服务

```powershell
cd apps/cv_service
$env:SAM_WEIGHTS="./app/models/sam_vit_h_4b8939.pth"
$env:OUTPUT_DIR="../../output"
python -m uvicorn app.main:app --reload --port 7001
```

### 2. 启动前端应用  

```powershell
cd apps/desktop
npm install
npm run dev
```

### 3. 准备媒体文件

- 视频文件: `apps/desktop/renderer/public/video/forest.mp4`
- 音效文件: `apps/desktop/renderer/public/audio/` (可选)

## 🎨 编辑器使用

### 步骤1: 上传画作

1. 点击"选择文件"按钮或输入图片路径
2. 支持格式: PNG, JPG, JPEG
3. 建议分辨率: 1024x1024以下

### 步骤2: 框选抠图

1. **矩形框选**: 在画作上拖拽选择要抠图的区域
2. **点击微调**: 点击图片添加前景点(绿点)或背景点(红点)
3. **实时预览**: 查看AI生成的多个候选掩码结果

### 步骤3: 选择结果

1. 在右侧候选列表中点击最佳结果
2. 查看抠图效果预览
3. 点击"导出PNG"下载透明背景的抠图文件

## 🌲 森林舞台使用

### 进入舞台

1. 点击顶部"森林舞台"标签
2. 点击"🎬 进入沉浸模式"开启全屏体验

### 互动功能

- **🖱️ 拖拽移动**: 鼠标拖拽元素到任意位置
- **🔊 音效触发**: 点击元素播放专属音效  
- **🎭 动画观赏**: 自动播放摇摆、飞行等动画效果
- **➕ 添加元素**: 点击按钮添加最新抠图元素

### 动画类型

- **🍃 摇摆 (sway)**: 温和的左右摇摆动画
- **✈️ 飞行 (fly)**: 波浪式飞行轨迹  
- **🚶 移动 (move)**: 沿预设路径移动
- **😴 静止 (idle)**: 保持静态状态

## 🎵 音效系统

### 音效配置

在 `public/audio/` 目录下放置音效文件:

- `bird.mp3` - 鸟类音效
- `dog.mp3` - 动物音效
- `wind.mp3` - 风声音效

### 触发机制

- 点击元素时播放音效
- 支持音量控制 (0.0-1.0)
- 可设置循环播放

## 🔧 自定义配置

### 动画参数

```typescript
animation: {
  type: 'sway',      // 动画类型
  speed: 1.0,        // 速度倍数  
  amplitude: 10,     // 摇摆幅度
  phase: 0           // 初始相位
}
```

### 音效设置

```typescript
sound: {
  audio: new Audio('/audio/bird.mp3'),
  loop: true,        // 循环播放
  volume: 0.3        // 音量 (0.0-1.0)
}
```

## 🚨 常见问题

### Q: 黑屏无法显示？

**A**: 检查是否已安装React类型定义并存在视频文件

```powershell
npm install @types/react @types/react-dom
```

### Q: SAM服务连接失败？

**A**: 验证后端服务状态

```
访问: http://localhost:7001/health
```

### Q: 音效无法播放？

**A**: 确保音频文件存在且格式正确 (MP3/WAV)

### Q: 抠图效果不理想？

**A**: 尝试以下方法:

- 调整框选区域大小
- 添加更多前景/背景点
- 选择不同的候选掩码

## 📋 系统要求

### 硬件要求

- **CPU**: Intel i5 或同等性能
- **内存**: 16GB+ RAM
- **显卡**: 支持WebGL 2.0
- **存储**: 5GB+ 可用空间

### 软件环境  

- **操作系统**: Windows 10/11, macOS 10.15+, Linux
- **Node.js**: 16.0+
- **Python**: 3.8+
- **浏览器**: Chrome 80+, Firefox 75+

## 🎯 最佳实践

### 图片处理建议

- 选择清晰、高对比度的儿童画作
- 确保要抠图的元素边界清晰
- 避免过于复杂的背景

### 性能优化

- 控制同时显示的元素数量 (建议<20个)
- 使用适当大小的图片文件
- 定期清理临时文件

### 创意展示

- 组合不同动画类型的元素
- 利用音效增强沉浸感
- 创建主题化的森林场景

## 🎪 展示效果

### 教育应用

- **儿童美术展**: 让静态画作"活"起来
- **互动教学**: 增强孩子的创作兴趣
- **艺术治疗**: 通过互动提升参与度

### 商业价值

- **数字画廊**: 创新的艺术展示方式
- **儿童乐园**: 沉浸式娱乐体验
- **教育机构**: 现代化教学工具

---

**开始您的互动森林之旅，让每一幅画作都充满生命力！** ✨🌲
